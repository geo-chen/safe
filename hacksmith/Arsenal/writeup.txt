Tool Description/Abstract

Security incidents are usually created by alerts or events, which are based on a small set of forwarded logs. When a server is suspected to be compromised, we go back to the host machine to perform forensics on the rest of the logs to investigate the network traffic and endpoint.

Sample Analysing Forensics Examiner (SAFE) enables security administrators/engineers to run automated forensics investigations effortlessly on a selected set of machines, either specified or via sampling, to get a baseline threat score on the likelyhood of a server compromise. A number of logs, including web server, syslog, system, network logs are surveyed for this analysis. With SAFE, security engineers can easily survey a selected pool of servers to hunt for any potential infection or compromise.


Tool Details

There are four main features in SAFE:
 1. Sampling based on 95% confidence level and stipulated confidence interval
 2. Acqusition of forensics artefacts on host machines
 3. Automatic remote orchestration and log ingestion
 4. Analysis to churn out a threat score that is indicative of the likelyhood of server compromise

1. Sampling
-----------
There are two modes on choosing target servers - Sampling and Specified.
Sampling is used on larger pools of servers where we either want confirmation on the security health of target pool, or perform threat hunting (in this case, potentially undetected compromised servers).

Sampling is based on 95% Confidence Level, a chosen Confidence Interval between 0.1 and 50, and the population size. 


2. Forensics Acqusition Scripts
-------------------------------
Current forensics scripts come in two flavours - Linux and Windows. These scripts:
 1. Collect filtered log entries for the purpose of threat scoring
 2. Collect all other useful logs for manual investigations
 
3. Remote Orchestration & Log Ingestion
---------------------------------------
Remote orchestration on target machines can be configured using any one of the following options:
 1. SSH Keys
 2. Role-based user with administrative privileges
 3. Service account with administrative privileges
 4. If SSH service is exposed, using SSH credentials
 
Without sudo/admin rights, log collection would be limited. 

The current setup provides two options for log ingestion:
 1. Splunk forwarder - installing splunk forwarder on the master server where the forensics scripts are run.
 2. Dropbox - setting up syncing Dropbox folders on master server and Splunk server.
 
In our tests over mobile network, the time taken for syncing and ingesting was within ten seconds.

4. Analysis and Threat Scoring
---------------------------------
3 Levels of rules are performed. First level is the "Base" rules where forensics log statistics are filtered according to predefined criteria and thresholds to highlight notable events. The second level, "Baseline" rules compares the current statistics with the previous capture that is at least 48 hours ago to highlight changes from the previous benchmark. The third level, "Notable Scoring", picks up the notable events created by the first two levels of rules, and applies individual points to calculate an eventual threat score for the various hosts.


Please visit our git repo for more details.